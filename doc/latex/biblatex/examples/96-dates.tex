%
% This file demonstrates various date formats and tests which apply to them
% for output
%
\documentclass[a4paper]{article}
\usepackage{fontspec}
\usepackage[american]{babel}
\usepackage{csquotes}
\usepackage{filecontents}
\begin{filecontents}{\jobname.bib}
@misc{date1,
  note      = {years with implicit and explicit eras},
  date      = {-477},         % Negative ISO8601 date = BCE/BC
  origdate  = {-877/-866},    % Negative ISO8601 date range
  eventdate = {840BC/830BC},  % Explicit era (CE/AD/BCE/BC)
  urldate   = {2004 CE},      % Explicit era (CE/AD/BCE/BC)
}
@misc{date2,
  note      = {dates with implicit and explicit eras},
  date      = {-08770203},            % Negative ISO8601 date with month and day
  origdate  = {8780203 BCE},          % Explicit era with month and day
  eventdate = {840-01BC/830-05BC},    % Explicit era range with month 
  urldate   = {1976-03 AD/1976-05 CE} % Explicit era range with month 
}
@misc{date3,
  note      = {dates with circa and uncertain markers},
  date      = {c 1723},        % year with circa marker
  origdate  = {ca. 1934-02},   % year and month with circa marker
  eventdate = {circa 1922 CE}, % circa and explicit era
  urldate   = {1976?}          % year with uncertainty marker
}
@misc{date4,
  note      = {dates with open ends},
  date      = {c 1723/},        % open-ended year range with circa marker
  origdate  = {ca. 1934-02/},   % open-ended year and month range with circa marker
  eventdate = {circa 1922 CE/}, % open-ended year range with circa and explicit era
  urldate   = {1976?/}          % open-ended year range with uncertainty marker
}
@misc{date5,
  % uses the 'nodate' localisation string due to default \DeclareLabeldate setting
  note      = {date from literal/localisation string},
}
\end{filecontents}
\usepackage[style=authoryear,%
            alldates=short,%
            dateera=secular,%
            dateuncertain=true,%
            datecirca=true,%
            backend=biber]{biblatex}
\addbibresource{\jobname.bib}


\defbibenvironment{simple}
{\list{}
   {\setlength{\leftmargin}{0pt}%
    \setlength{\itemindent}{0pt}%
    \setlength{\bibitemsep}{2ex}%
    \setlength{\itemsep}{\bibitemsep}%
    \setlength{\parsep}{\bibparsep}}}
{\endlist}
{\item}

\DeclareFieldFormat{urldate}{#1}

\DeclareBibliographyDriver{misc}{%
  \printfield[emph]{note}\\
  \iffieldundef{labelyear}{}{\printtext[bold]{labeldate} = \printdatelabel\\}
  \iffieldundef{year}{}{\printtext[bold]{date} = \printdate\\}
  \iffieldundef{origyear}{}{\printtext[bold]{origdate} = \printorigdate\\}
  \iffieldundef{eventyear}{}{\printtext[bold]{eventdate} = \printeventdate\\}
  \iffieldundef{urlyear}{}{\printtext[bold]{urldate} = \printurldate}}

% This will output eras for all dates
%
% \renewcommand*{\dateeraprint}{%
%   \ifdateera{bce}
%     {\printdelim{dateeradelim}\bibstring{beforecommonera}}
%     {\printdelim{dateeradelim}\bibstring{commonera}}}


% This will only output era information for dates with year < 500
% Has to be done inside the appropriate \mkbibdate* macros as before this
% the date field names are not available.
%
% \renewcommand*{\dateeraprint}{}%
% \DefineBibliographyExtras{english}{%
% \protected\def\mkbibdateshort#1#2#3{%
%    \iffieldundef{#2}
%     {}
%     {\mkdatezeros{\thefield{#2}}%
%       \iffieldundef{#3}
%         {\iffieldundef{#1}{}{/}}
%         {/}}%
%   \iffieldundef{#3}
%     {}
%     {\mkdatezeros{\thefield{#3}}%
%        \iffieldundef{#1}{}{/}}%
%   \iffieldbibstring{#1}
%     {\bibstring{\thefield{#1}}}
%     {\mkdatezeros{\thefield{#1}}}%
%   \ifdateera{bce}
%     {\ifnumcomp{\thefield{#1}}{<}{500}
%       {\printdelim{dateeradelim}\bibstring{beforecommonera}}
%       {}}
%     {}}}

\begin{document}

\section*{Date formats}

This example parses and formats some of the supported date formats and
demonstrates the output options. See the source for details.
\nocite{*}

\printbibliography[env=simple,title={Examples}]
\end{document}
