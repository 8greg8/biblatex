%
% This file demonstrates various date formats and tests which apply to them
% for output
%
\documentclass[a4paper]{article}
\usepackage{fontspec}
\usepackage[american]{babel}
\usepackage{csquotes}
\usepackage{filecontents}
\begin{filecontents}{\jobname.bib}
@misc{date1,
  note      = {years with implicit era},
  date      = {-0477},        % Negative EDTF date = BCE/BC
  origdate  = {-0877/-0866},  % Negative ETDF date range
  eventdate = {0477/0566},    % Forced CE era due to dateeraauto setting
  urldate   = {-0020/0100},   % Cross BCE/CE range
}
@misc{date2,
  note      = {dates with circa and uncertain markers},
  date      = {1723?~},        % year with ETDF approximate (circa) and uncertainty markers
  origdate  = {1934-02~},      % year and month with circa marker
  eventdate = {1976?},         % year with EDTF uncertainty marker
  urldate   = {1922~},         % year with ETDF approximate (circa) marker
}
@misc{date3,
  note      = {date ranges},
  date      = {1934~/1936~},    % year range with circa markers
  origdate  = {1723~/},         % open-ended year range with circa marker
  eventdate = {1976?/},         % open-ended year range with uncertainty marker
  urldate   = {1976/open}       % open-ended year range with EDTF open marker
}
@misc{date4,
  note      = {times},
  date      = {2004-04-05T14:34:00},                     % Date with time, floating timezone
  origdate  = {2004-04-05T14:34:00Z},                    % Date with time, UTC timezone
  eventdate = {2004-04-05T14:34:00+05:00},               % Date with time, explicit timezone
  urldate   = {2004-04-05T14:34:00/2004-04-05T15:00:00}, % Datetime range
}
@misc{date5,
  note      = {seasons},
  date      = {1723-21},          % EDTF season (21=spring, 22=summer, 23=autumn, 24=winter)
  origdate  = {1934-24~},         % uncertain year plus season
  eventdate = {1934-22/1934-23},  % range with seasons
}
@misc{date6,
  % uses the 'nodate' localisation string due to default \DeclareLabeldate setting
  note      = {date from literal/localisation string},
}
@misc{date7,
  note      = {unspecified},
  date      = {19uu},         % EDTF unspecified year in century
  origdate  = {199u},         % EDTF unspecified year in decade
}

\end{filecontents}
\usepackage[style=authoryear,%
            alldates=short,%
            alltimes=HH,%
            datezeros=false,%
            dateera=secular,%
            dateeraauto=600,%
            dateuncertain=true,%
            datecirca=true,%
            sorting=none,%
            backend=biber]{biblatex}
\addbibresource{\jobname.bib}


\defbibenvironment{simple}
{\list{}
   {\setlength{\leftmargin}{0pt}%
    \setlength{\itemindent}{0pt}%
    \setlength{\bibitemsep}{1ex}%
    \setlength{\itemsep}{\bibitemsep}%
    \setlength{\parsep}{\bibparsep}}}
{\endlist}
{\item}

\DeclareFieldFormat{urldate}{#1}
\DeclareFieldFormat{time}{\mkbibemph{#1}}
\DeclareFieldFormat{labeltime}{\mkbibemph{#1}}
\DeclareFieldFormat{origtime}{\mkbibemph{#1}}
\DeclareFieldFormat{eventtime}{\mkbibemph{#1}}
\DeclareFieldFormat{urltime}{\mkbibemph{#1}}

\makeatletter
\DeclareBibliographyDriver{misc}{%
  \printfield[emph]{note}\\
  \iffieldundef{labelyear}{}{%
    \printtext[bold]{labeldate = }\printlabeldate\addspace\printlabeltime
    \iffieldundef{labelseason}{}{\space(\bibstring{\thefield{labelseason}}%
      \iffieldundef{labelendseason}{)}{\bibrangedash\bibstring{\thefield{labelendseason}})}}%
    \\}
  \iffieldundef{year}{}{%
    \iffieldequalstr{dateunspecified}{yearincentury}
      {\printtext[bold]{date = }\number\numexpr\thefield{year}/100+1\relax th Century}
      {\printtext[bold]{date = }\printdate\addspace\printtime}%
    \iffieldundef{season}{}{\space(\bibstring{\thefield{season}}%
      \iffieldundef{endseason}{)}{\bibrangedash\bibstring{\thefield{endseason}})}}%
    \\}
  \iffieldundef{origyear}{}{%
    \iffieldequalstr{origdateunspecified}{yearindecade}
      {\printtext[bold]{date = }The \expandafter\@gobbletwo\number\thefield{origyear}s}
      {\printtext[bold]{origdate = }\printorigdate\addspace\printorigtime}%
    \iffieldundef{origseason}{}{\space(\bibstring{\thefield{origseason}}%
      \iffieldundef{origendseason}{)}{\bibrangedash\bibstring{\thefield{origendseason}})}}%
    \\}
  \iffieldundef{eventyear}{}{%
    \printtext[bold]{eventdate = }\printeventdate\addspace\printeventtime
    \iffieldundef{eventseason}{}{\space(\bibstring{\thefield{eventseason}}%
      \iffieldundef{eventendseason}{)}{\bibrangedash\bibstring{\thefield{eventendseason}})}}%
    \\}
  \iffieldundef{urlyear}{}{%
    \printtext[bold]{urldate = }\printurldate\addspace\printurltime
    \iffieldundef{urlseason}{}{\space(\bibstring{\thefield{urlseason}}%
      \iffieldundef{urlendseason}{)}{\bibrangedash\bibstring{\thefield{urlendseason}})}}%
  }}
\makeatother

\begin{document}
\section*{Date formats}
This example parses and formats some of the supported date formats and
demonstrates the output options. See the source for details. Some citation
examples: \cite{date1}, \cite{date2}, \cite{date3}, \cite{date4},
\cite{date5}, \cite{date6}, \cite{date7}
\printbibliography[env=simple,title={Examples}]
\end{document}
