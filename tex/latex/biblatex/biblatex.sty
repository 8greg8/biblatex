%%
%% This is file `biblatex.sty'.
%%

% Set up the version strings here, so they are the same for both branches
\def\abx@date{2012/04/29}
\def\abx@version{1.7a}
\def\abx@bbxid{\abx@date v\abx@version biblatex bibliography style (PK/JW/AB)}
\def\abx@cbxid{\abx@date v\abx@version biblatex citation style (PK/JW/AB)}
\def\abx@lbxid{\abx@date v\abx@version biblatex localization (PK/JW/AB)}
\def\abx@cptid{\abx@date v\abx@version biblatex compatibility (PK/JW/AB)}
\def\blx@bblversion{\abx@version}

\NeedsTeXFormat{LaTeX2e}[2005/12/01]
\ProvidesPackage{biblatex}
  [\abx@date v\abx@version programmable bibliographies (PK/JW/AB)]

% Set up a switch for choosing the version
\newif\ifblx@load@version@one

% Fake keyval options to detect the backend
% All basically the same, so passing the backend is done simply
\DeclareOption{backend=bibtex}{%
  \PassOptionsToClass{\CurrentOption}{biblatex1}%
  \blx@load@version@onetrue
}
\DeclareOption{backend=bibtex8}{%
  \PassOptionsToClass{\CurrentOption}{biblatex1}%
  \blx@load@version@onetrue
}
\DeclareOption{backend=bibtexu}{%
  \PassOptionsToClass{\CurrentOption}{biblatex1}%
  \blx@load@version@onetrue
}
\DeclareOption{backend=biber}{%
  \PassOptionsToClass{\CurrentOption}{biblatex2}%
  \blx@load@version@onefalse
}
\DeclareOption*{%
  \PassOptionsToClass{\CurrentOption}{biblatex1}%
  \PassOptionsToClass{\CurrentOption}{biblatex2}%
}

% Default to the BibTeX backend, at least for now
\ExecuteOptions{backend=bibtex}
\ProcessOptions\relax

% Now do the loading: avoid any awkward stuff with the conditional by
% expanding first
\ifblx@load@version@one
  \expandafter\@firstoftwo
\else
  \expandafter\@secondoftwo
\fi
  {%
    % This is not defined by v1, but is used in biblatex.def so 
    % has to be handled
    \protected\long\def\DeclareLabelalphaTemplate#1{}
    \RequirePackage{biblatex1}
  }
  {\RequirePackage{biblatex2}}

%% Copyright (C) 2006-2011 Philipp Lehman
%%               2012 Philip Kime, Audrey Boruvka, Joseph Wright
%% 
%% It may be distributed and/or modified under the conditions of
%% the LaTeX Project Public License (LPPL), either version 1.3c of
%% this license or (at your option) any later version.  The latest
%% version of this license is in the file:
%% 
%%    http://www.latex-project.org/lppl.txt
%% 
%% This work is "maintained" (as per LPPL maintenance status) by
%%   Philip Kime, Audrey Boruvka, Joseph Wright.
